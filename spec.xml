<?xml version="1.0" encoding="UTF-8"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc2629 version 1.2.12 -->

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!ENTITY RFC2119 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC8174 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml">
<!ENTITY RFC6749 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.6749.xml">
<!ENTITY I-D.wdenniss-oauth-device-posture SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml3/reference.I-D.wdenniss-oauth-device-posture.xml">
<!ENTITY RFC7662 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7662.xml">
]>


<rfc docName="draft-hanson-oauth-scss-00" category="std">

  <front>
    <title abbrev="OAuth 2.0 SCSS">OAuth 2.0 Session Continuity and Signal Sharing</title>

    <author initials="J." surname="Hanson" fullname="Jared Hanson">
      <organization>Okta</organization>
      <address>
        <email>jared.hanson@okta.com</email>
      </address>
    </author>
    <author initials="K." surname="McGuinness" fullname="Karl McGuinness">
      <organization>Okta</organization>
      <address>
        <email>kmcguinness@okta.com</email>
      </address>
    </author>

    <date year="2019" month="October" day="30"/>

    <area>Security</area>
    <workgroup>Web Authorization Protocol</workgroup>
    

    <abstract>


<t>This specification defines a mechanism in which clients and resource servers can
share session signals with an authorization server.  These signals are
transported using existing OAuth 2.0 endpoints, providing a lightweight approach
to continuous authorization.</t>



    </abstract>


  </front>

  <middle>


<section anchor="introduction" title="Introduction">

<t>In OAuth, an authorization server issues access tokens to clients, which are
used to access protected resources hosted by a resource server.  Prior to
issuing tokens, the authorization server authenticates the end-user and obtains
consent.  This interaction establishes a session in which the end-user accesses
both the authorization server and one or more applications.</t>

<t>These sessions can be long-lived, lasting for days or months.  During this time,
the status of the end-user and her device, such as location, network address, or
security posture, may change - requring a change in access privileges.
Unfortunately, typical OAuth deployments determine access only at the time of
authentication and lack awareness of dynamically changing information about
ongoing sessions.</t>

<t>This specification defines a mechanism in which clients and resource servers can
share session signals with an authorization server.  These signals are
transported using existing OAuth 2.0 endpoints.  Use of existing endpoints is
intended to provide a lightweight approach to continuous authorization, while
complimenting future protocols that provide real-time access evaluation using a
publish-subscribe approach.</t>

<section anchor="notational-conventions" title="Notational Conventions">

<t>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL
NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “NOT RECOMMENDED”,
“MAY”, and “OPTIONAL” in this document are to be interpreted as
described in BCP 14 <xref target="RFC2119"/> <xref target="RFC8174"/> when, and only when, they
appear in all capitals, as shown here.</t>

</section>
<section anchor="client-profiles" title="Client Profiles">

<t>This specification has been designed around the client profiles defined in
Section 2.1 of <xref target="RFC6749"/>:</t>

<t><list style="hanging">
  <t hangText='web application:'>
  A web application is a confidential client running on a web server.  Resource
owners access the client via an HTML user interface rendered in a user-agent on
the device used by the resource owner.  The client credentials as well as any
access token issued to the client are stored on the web server and are not
exposed to or accessible by the resource owner.</t>
  <t hangText='user-agent-based application:'>
  A user-agent-based application is a public client in which the client code is
downloaded from a web server and executes within a user-agent (e.g., web
browser) on the device used by the resource owner.  Protocol data and
credentials are easily accessible (and often visible) to the resource owner.
Since such applications reside within the user-agent, they can make seamless use
of the user-agent capabilities when requesting authorization.</t>
  <t hangText='native application:'>
  A native application is a public client installed and executed on the device
used by the resource owner.  Protocol data and credentials are accessible to the
resource owner.  It is assumed that any client authentication credentials
included in the application can be extracted.  On the other hand, dynamically
issued credentials such as access tokens or refresh tokens can receive an
acceptable level of protection.  At a minimum, these credentials are protected
from hostile servers with which the application may interact.  On some
platforms, these credentials might be protected from other applications residing
on the same device.</t>
</list></t>

</section>
<section anchor="token-locality" title="Token Locality">

<t>After obtaining approval of the end-user via interaction within the end-user’s
user-agent, OAuth issues delegation-specific access tokens and refresh tokens to
clients.  This specification defines two token localities, based on where tokens
reside relative to the user-agent in which the issuance was approved:</t>

<t><list style="hanging">
  <t hangText='off device:'>
  A token is off device when it resides with an application that is not located
on the same device as the end-user’s user-agent.  Tokens issued to a web
application are off device, as the application runs on a web server acceessed
remotely via the user-agent.</t>
  <t hangText='on device:'>
  A token is on device when it resides with an application that is located on
the same device as the end-user’s user-agent.  Tokens issued to native
native applications and user-agent-based applications are on device, as the
application is executing either on the device or within the user-agent itself.</t>
</list></t>

</section>
</section>
<section anchor="signal-sharing" title="Signal Sharing">

<section anchor="refreshing-an-access-token" title="Refreshing an Access Token">

<section anchor="from-on-device" title="From On Device">

<t>A native application possessing a refresh token that is on device shares signals
by making a refresh request that includes device posture, as defined in section
6 of <xref target="I-D.wdenniss-oauth-device-posture"/>.</t>

<t>For example, the client makes the following HTTP request using transport-layer
security (with extra line breaks for display purposes only):</t>

<figure><artwork><![CDATA[
  POST /token HTTP/1.1
  Host: server.example.com
  Content-Type: application/x-www-form-urlencoded

  grant_type=refresh_token&refresh_token=tGzv3JOkF0XG5Qx2TlKWIA
  client_id=s6BhdRkqt3&device_posture=%7B%22screen_lock%22%3Atrue%2C
  %22device_os%22%3A%22iOS%22%2C%22device_os_version%22%3A%2211.1%22%7D
]]></artwork></figure>

</section>
<section anchor="from-off-device" title="From Off Device">

<t>A web application posessing a refresh token that is off device shares signals by
making a refresh request that includes user-agent posture, as defined by User
Agent Posture Signals.</t>

<t>For example, the client makes the following HTTP request using transport-layer
security (with extra line breaks for display purposes only):</t>

<figure><artwork><![CDATA[
  POST /token HTTP/1.1
  Host: server.example.com
  Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
  Content-Type: application/x-www-form-urlencoded

  grant_type=refresh_token&refresh_token=tGzv3JOkF0XG5Qx2TlKWIA
  client_id=s6BhdRkqt3&user_agent_posture=%7B%22user_agent%22%3A%22Mozilla%2F5.0
  %20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_14_5%29%20AppleWebKit%2F537.36
  %20%28KHTML%2C%20like%20Gecko%29%20Chrome%2F75.0.3770.142%20Safari%2F537.36%22
  %2C%22ip_address%22%3A%2293.184.216.34%22%7D
]]></artwork></figure>

<t>The client MUST only include user-agent posture in online access scenarios.
Refresh tokens used in offline scenarios, when the end-user is not present, are
decoupled from the session and lack end-user user agent context.</t>

</section>
</section>
<section anchor="token-introspection" title="Token Introspection">

<section anchor="introspection-request" title="Introspection Request">

<t>A resource server querying for to determine the state of an access token shares
signals by making an by making an introspection request to the introspection
endpoint, as defined in Section 2.1 of <xref target="RFC7662"/>.</t>

<t>In addition to the parameters defined by Section 2.1 of <xref target="RFC7662"/>, the
following parameters are also defined:</t>

<t><list style="hanging">
  <t hangText='user_agent_posture'>
  OPTIONAL. URL-encoded JSON dictionary, containing user-agent posture signals,
as defined by User Agent Posture Signals.</t>
</list></t>

<t>For example, the client makes the following HTTP request using transport-layer
security (with extra line breaks for display purposes only):</t>

<figure><artwork><![CDATA[
  POST /introspect HTTP/1.1
  Host: server.example.com
  Accept: application/json
  Content-Type: application/x-www-form-urlencoded
  Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW

  token=mF_9.B5f-4.1JqM&token_type_hint=access_token
  &user_agent_posture=%7B%22user_agent%22%3A%22Mozilla%2F5.0
  %20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_14_5%29%20AppleWebKit%2F537.36
  %20%28KHTML%2C%20like%20Gecko%29%20Chrome%2F75.0.3770.142%20Safari%2F537.36%22
  %2C%22ip_address%22%3A%2293.184.216.34%22%7D
]]></artwork></figure>

<t>Note that the locality of an access token is always off device when presented to
a resource server.</t>

</section>
</section>
</section>


  </middle>

  <back>

    <references title='Normative References'>

&RFC2119;
&RFC8174;
&RFC6749;
&I-D.wdenniss-oauth-device-posture;
&RFC7662;


    </references>




  </back>

<!-- ##markdown-source:
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

-->

</rfc>

