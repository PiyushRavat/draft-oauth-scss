<?xml version="1.0" encoding="UTF-8"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc2629 version 1.2.12 -->

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!ENTITY RFC6749 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.6749.xml">
<!ENTITY RFC2119 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC8174 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml">
<!ENTITY I-D.wdenniss-oauth-device-posture SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml3/reference.I-D.wdenniss-oauth-device-posture.xml">
<!ENTITY RFC7662 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7662.xml">
]>


<rfc docName="draft-hanson-oauth-scss-00" category="std">

  <front>
    <title abbrev="OAuth 2.0 SCSS">OAuth 2.0 Session Continuity and Signal Sharing</title>

    <author initials="J." surname="Hanson" fullname="Jared Hanson">
      <organization>Okta</organization>
      <address>
        <email>jared.hanson@okta.com</email>
      </address>
    </author>
    <author initials="K." surname="McGuinness" fullname="Karl McGuinness">
      <organization>Okta</organization>
      <address>
        <email>kmcguinness@okta.com</email>
      </address>
    </author>

    <date year="2019" month="October" day="30"/>

    <area>Security</area>
    <workgroup>Web Authorization Protocol</workgroup>
    

    <abstract>


<t>This specification defines a mechanism in which clients and resource servers can
share session signals with an authorization server.  These signals are
transported using existing OAuth 2.0 endpoints, providing a lightweight approach
to continuous authorization.</t>



    </abstract>


  </front>

  <middle>


<section anchor="introduction" title="Introduction">

<t>In OAuth, an authorization server issues access tokens to clients, which are
used to access protected resources hosted by a resource server.  Prior to
issuing tokens, the authorization server authenticates the end-user and obtains
consent.  This interaction establishes a session in which the end-user accesses
both the authorization server and one or more applications.</t>

<t>These sessions can be long-lived, lasting for days or months.  During this time,
the status of the end-user and her device, such as location, network address, or
security posture, may change - requring a change in access privileges.
Unfortunately, typical OAuth deployments determine access only at the time of
authentication and lack awareness of dynamically changing information about
ongoing sessions.</t>

<t>This specification defines a mechanism in which clients and resource servers can
share session signals with an authorization server.  These signals are
transported using existing OAuth 2.0 endpoints.  Use of existing endpoints is
intended to provide a lightweight approach to continuous authorization, while
complimenting future protocols that provide real-time access evaluation using a
publish-subscribe approach.</t>

<section anchor="client-profiles" title="Client Profiles">

<t>This specification has been designed around the client profiles defined in
Section 2.1 of <xref target="RFC6749"/>:</t>

<t><list style="hanging">
  <t hangText='web application:'><vspace blankLines='0'/>
  A web application is a confidential client running on a web server.  Resource
owners access the client via an HTML user interface rendered in a user-agent on
the device used by the resource owner.  The client credentials as well as any
access token issued to the client are stored on the web server and are not
exposed to or accessible by the resource owner.</t>
  <t hangText='user-agent-based application:'><vspace blankLines='0'/>
  A user-agent-based application is a public client in which the client code is
downloaded from a web server and executes within a user-agent (e.g., web
browser) on the device used by the resource owner.  Protocol data and
credentials are easily accessible (and often visible) to the resource owner.
Since such applications reside within the user-agent, they can make seamless use
of the user-agent capabilities when requesting authorization.</t>
  <t hangText='native application:'><vspace blankLines='0'/>
  A native application is a public client installed and executed on the device
used by the resource owner.  Protocol data and credentials are accessible to the
resource owner.  It is assumed that any client authentication credentials
included in the application can be extracted.  On the other hand, dynamically
issued credentials such as access tokens or refresh tokens can receive an
acceptable level of protection.  At a minimum, these credentials are protected
from hostile servers with which the application may interact.  On some
platforms, these credentials might be protected from other applications residing
on the same device.</t>
</list></t>

</section>
<section anchor="token-locality" title="Token Locality">

<t>After obtaining approval of the end-user via interaction within the end-user’s
user-agent, OAuth issues delegation-specific access tokens and refresh tokens to
clients.  This specification defines two token localities, based on where tokens
reside relative to the user-agent in which the issuance was approved:</t>

<t><list style="hanging">
  <t hangText='off device:'><vspace blankLines='0'/>
  A token is off device when it resides with an application that is not located
on the same device as the end-user’s user-agent.  Tokens issued to a web
application are off device, as the application runs on a web server acceessed
remotely via the user-agent.</t>
  <t hangText='on device:'><vspace blankLines='0'/>
  A token is on device when it resides with an application that is located on
the same device as the end-user’s user-agent.  Tokens issued to native
native applications and user-agent-based applications are on device, as the
application is executing either on the device or within the user-agent itself.</t>
</list></t>

</section>
<section anchor="notational-conventions" title="Notational Conventions">

<t>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL
NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “NOT RECOMMENDED”,
“MAY”, and “OPTIONAL” in this document are to be interpreted as
described in BCP 14 <xref target="RFC2119"/> <xref target="RFC8174"/> when, and only when, they
appear in all capitals, as shown here.</t>

</section>
</section>
<section anchor="signal-sharing" title="Signal Sharing">

<section anchor="refreshing-an-access-token" title="Refreshing an Access Token">

<section anchor="from-on-device" title="From On Device">

<t>A native application possessing a refresh token that is on device shares signals
by making a refresh request that includes device posture, as defined in section
6 of <xref target="I-D.wdenniss-oauth-device-posture"/>.</t>

<t>For example, the client makes the following HTTP request using transport-layer
security (with extra line breaks for display purposes only):</t>

<figure><artwork><![CDATA[
  POST /token HTTP/1.1
  Host: server.example.com
  Content-Type: application/x-www-form-urlencoded

  grant_type=refresh_token&refresh_token=tGzv3JOkF0XG5Qx2TlKWIA
  client_id=s6BhdRkqt3&device_posture=%7B%22screen_lock%22%3Atrue%2C
  %22device_os%22%3A%22iOS%22%2C%22device_os_version%22%3A%2211.1%22%7D
]]></artwork></figure>

</section>
<section anchor="from-off-device" title="From Off Device">

<t>A web application posessing a refresh token that is off device shares signals by
making a refresh request that includes user-agent posture, as defined by User
Agent Posture Signals.</t>

<t>For example, the client makes the following HTTP request using transport-layer
security (with extra line breaks for display purposes only):</t>

<figure><artwork><![CDATA[
  POST /token HTTP/1.1
  Host: server.example.com
  Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
  Content-Type: application/x-www-form-urlencoded

  grant_type=refresh_token&refresh_token=tGzv3JOkF0XG5Qx2TlKWIA
  client_id=s6BhdRkqt3&user_agent_posture=%7B%22user_agent%22%3A%22Mozilla%2F5.0
  %20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_14_5%29%20AppleWebKit%2F537.36
  %20%28KHTML%2C%20like%20Gecko%29%20Chrome%2F75.0.3770.142%20Safari%2F537.36%22
  %2C%22ip_address%22%3A%2293.184.216.34%22%7D
]]></artwork></figure>

<t>The client MUST only include user-agent posture in online access scenarios.
Refresh tokens used in offline scenarios, when the end-user is not present, are
decoupled from the session and lack end-user user agent context.</t>

</section>
</section>
<section anchor="token-introspection" title="Token Introspection">

<section anchor="introspection-request" title="Introspection Request">

<t>A resource server querying for to determine the state of an access token shares
signals by making an by making an introspection request to the introspection
endpoint, as defined in Section 2.1 of <xref target="RFC7662"/>.</t>

<t>In addition to the parameters defined by Section 2.1 of <xref target="RFC7662"/>, the
following parameters are also defined:</t>

<t><list style="hanging">
  <t hangText='user_agent_posture'>
  OPTIONAL. URL-encoded JSON dictionary, containing user-agent posture signals,
as defined by User Agent Posture Signals.</t>
</list></t>

<t>For example, the client makes the following HTTP request using transport-layer
security (with extra line breaks for display purposes only):</t>

<figure><artwork><![CDATA[
  POST /introspect HTTP/1.1
  Host: server.example.com
  Accept: application/json
  Content-Type: application/x-www-form-urlencoded
  Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW

  token=mF_9.B5f-4.1JqM&token_type_hint=access_token
  &user_agent_posture=%7B%22user_agent%22%3A%22Mozilla%2F5.0
  %20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_14_5%29%20AppleWebKit%2F537.36
  %20%28KHTML%2C%20like%20Gecko%29%20Chrome%2F75.0.3770.142%20Safari%2F537.36%22
  %2C%22ip_address%22%3A%2293.184.216.34%22%7D
]]></artwork></figure>

<t>Note that the locality of an access token is always off device when presented to
a resource server.</t>

</section>
</section>
</section>


  </middle>

  <back>

    <references title='Normative References'>

&RFC6749;
&RFC2119;
&RFC8174;
&I-D.wdenniss-oauth-device-posture;
&RFC7662;


    </references>




  </back>

<!-- ##markdown-source:
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
nM1DBB8AAA==

-->

</rfc>

