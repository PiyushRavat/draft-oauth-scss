<?xml version="1.0" encoding="UTF-8"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc2629 version 1.2.12 -->

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!ENTITY RFC2119 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC8174 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml">
<!ENTITY RFC6749 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.6749.xml">
<!ENTITY I-D.wdenniss-oauth-device-posture SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml3/reference.I-D.wdenniss-oauth-device-posture.xml">
<!ENTITY RFC7662 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7662.xml">
]>


<rfc docName="draft-hanson-oauth-scss-00" category="std">

  <front>
    <title abbrev="scss">OAuth 2.0 Session Continuity and Signal Sharing</title>

    <author initials="J." surname="Hanson" fullname="Jared Hanson">
      <organization>Okta</organization>
      <address>
        <email>jared.hanson@okta.com</email>
      </address>
    </author>
    <author initials="K." surname="McGuinness" fullname="Karl McGuinness">
      <organization>Okta</organization>
      <address>
        <email>kmcguinness@okta.com</email>
      </address>
    </author>

    <date year="2019" month="October" day="30"/>

    <area>Security</area>
    <workgroup>Web Authorization Protocol</workgroup>
    

    <abstract>


<t>This specification defines a mechanism in which clients and resource servers can
share session signals with an authorization server.  These signals are
transported using existing OAuth 2.0 endpoints, providing a lightweight approach
to continuous authorization.</t>



    </abstract>


  </front>

  <middle>


<section anchor="problems2" title="Introduction">

<t>In OAuth, an authorization server issues access tokens to clients, which are
used to access protected resources hosted by a resource server.  Prior to
issuing tokens, the authorization server authenticates the end-user and obtains
consent.  This interaction establishes a session in which the end-user accesses
both the authorization server and one or more applications.</t>

<t>These sessions can be long-lived, lasting for days or months.  During this time,
the status of the end-user and her device, such as location, network address, or
security posture, may change - requring a change in access privileges.
Unfortunately, typical OAuth deployments determine access only at the time of
authentication and lack awareness of dynamically changing information about
ongoing sessions.</t>

<t>This specification defines a mechanism in which clients and resource servers can
share session signals with an authorization server.  These signals are
transported using existing OAuth 2.0 endpoints.  Use of existing endpoints is
intended to provide a lightweight approach to continuous authorization, while
complimenting future protocols that provide real-time access evaluation using a
publish-subscribe approach.</t>

<section anchor="notational-conventions" title="Notational Conventions">

<t>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL
NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “NOT RECOMMENDED”,
“MAY”, and “OPTIONAL” in this document are to be interpreted as
described in BCP 14 <xref target="RFC2119"/> <xref target="RFC8174"/> when, and only when, they
appear in all capitals, as shown here.</t>

</section>
<section anchor="client-profiles" title="Client Profiles">

<t>This specification has been designed around the client profiles defined in
Section 2.1 of <xref target="RFC6749"/>:</t>

<t><list style="hanging">
  <t hangText='web application:'>
  A web application is a confidential client running on a web server.  Resource
owners access the client via an HTML user interface rendered in a user-agent on
the device used by the resource owner.  The client credentials as well as any
access token issued to the client are stored on the web server and are not
exposed to or accessible by the resource owner.</t>
  <t hangText='user-agent-based application:'>
  A user-agent-based application is a public client in which the client code is
downloaded from a web server and executes within a user-agent (e.g., web
browser) on the device used by the resource owner.  Protocol data and
credentials are easily accessible (and often visible) to the resource owner.
Since such applications reside within the user-agent, they can make seamless use
of the user-agent capabilities when requesting authorization.</t>
  <t hangText='native application:'>
  A native application is a public client installed and executed on the device
used by the resource owner.  Protocol data and credentials are accessible to the
resource owner.  It is assumed that any client authentication credentials
included in the application can be extracted.  On the other hand, dynamically
issued credentials such as access tokens or refresh tokens can receive an
acceptable level of protection.  At a minimum, these credentials are protected
from hostile servers with which the application may interact.  On some
platforms, these credentials might be protected from other applications residing
on the same device.</t>
</list></t>

</section>
<section anchor="token-locality" title="Token Locality">

<t>After obtaining approval of the end-user via interaction within the end-user’s
user-agent, OAuth issues delegation-specific access tokens and refresh tokens to
clients.  This specification defines two token localities, based on where tokens
reside relative to the user-agent in which the issuance was approved:</t>

<t><list style="hanging">
  <t hangText='off device:'>
  A token is off device when it resides with an application that is not located
on the same device as the end-user’s user-agent.  Tokens issued to a web
application are off device, as the application runs on a web server acceessed
remotely via the user-agent.</t>
  <t hangText='on device:'>
  A token is on device when it resides with an application that is located on
the same device as the end-user’s user-agent.  Tokens issued to native
native applications and user-agent-based applications are on device, as the
application is executing either on the device or within the user-agent itself.</t>
</list></t>

</section>
</section>
<section anchor="problems8" title="Signal Sharing">

<section anchor="refreshing-an-access-token" title="Refreshing an Access Token">

<section anchor="from-on-device" title="From On Device">

<t>A native application possessing a refresh token that is on device shares signals
by making a refresh request that includes device posture, as defined in section
6 of <xref target="I-D.wdenniss-oauth-device-posture"/>.</t>

<t>For example, the client makes the following HTTP request using transport-layer
security (with extra line breaks for display purposes only):</t>

<figure><artwork><![CDATA[
  POST /token HTTP/1.1
  Host: server.example.com
  Content-Type: application/x-www-form-urlencoded

  grant_type=refresh_token&refresh_token=tGzv3JOkF0XG5Qx2TlKWIA
  client_id=s6BhdRkqt3&device_posture=%7B%22screen_lock%22%3Atrue%2C
  %22device_os%22%3A%22iOS%22%2C%22device_os_version%22%3A%2211.1%22%7D
]]></artwork></figure>

</section>
<section anchor="from-off-device" title="From Off Device">

<t>A web application posessing a refresh token that is off device shares signals by
making a refresh request that includes user-agent posture, as defined by User
Agent Posture Signals.</t>

<t>For example, the client makes the following HTTP request using transport-layer
security (with extra line breaks for display purposes only):</t>

<figure><artwork><![CDATA[
  POST /token HTTP/1.1
  Host: server.example.com
  Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
  Content-Type: application/x-www-form-urlencoded

  grant_type=refresh_token&refresh_token=tGzv3JOkF0XG5Qx2TlKWIA
  client_id=s6BhdRkqt3&user_agent_posture=%7B%22user_agent%22%3A%22Mozilla%2F5.0
  %20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_14_5%29%20AppleWebKit%2F537.36
  %20%28KHTML%2C%20like%20Gecko%29%20Chrome%2F75.0.3770.142%20Safari%2F537.36%22
  %2C%22ip_address%22%3A%2293.184.216.34%22%7D
]]></artwork></figure>

<t>The client MUST only include user-agent posture in online access scenarios.
Refresh tokens used in offline scenarios, when the end-user is not present, are
decoupled from the session and lack end-user user agent context.</t>

</section>
</section>
<section anchor="token-introspection" title="Token Introspection">

<section anchor="introspection-request" title="Introspection Request">

<t>A resource server querying for to determine the state of an access token shares
signals by making an by making an introspection request to the introspection
endpoint, as defined in Section 2.1 of <xref target="RFC7662"/>.</t>

<t>In addition to the parameters defined by Section 2.1 of <xref target="RFC7662"/>, the
following parameters are also defined:</t>

<t><list style="hanging">
  <t hangText='user_agent_posture'>
  OPTIONAL. URL-encoded JSON dictionary, containing user-agent posture signals,
as defined by User Agent Posture Signals.</t>
</list></t>

<t>For example, the client makes the following HTTP request using transport-layer
security (with extra line breaks for display purposes only):</t>

<figure><artwork><![CDATA[
  POST /introspect HTTP/1.1
  Host: server.example.com
  Accept: application/json
  Content-Type: application/x-www-form-urlencoded
  Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW

  token=mF_9.B5f-4.1JqM&token_type_hint=access_token
  &user_agent_posture=%7B%22user_agent%22%3A%22Mozilla%2F5.0
  %20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_14_5%29%20AppleWebKit%2F537.36
  %20%28KHTML%2C%20like%20Gecko%29%20Chrome%2F75.0.3770.142%20Safari%2F537.36%22
  %2C%22ip_address%22%3A%2293.184.216.34%22%7D
]]></artwork></figure>

<t>Note that the locality of an access token is always off device when presented to
a resource server.</t>

</section>
</section>
</section>


  </middle>

  <back>

    <references title='Normative References'>

&RFC2119;
&RFC8174;
&RFC6749;
&I-D.wdenniss-oauth-device-posture;
&RFC7662;


    </references>




  </back>

<!-- ##markdown-source:
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
8W9S0bZSBR8AAA==

-->

</rfc>

